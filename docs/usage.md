# 桌面自动化脚本 - 使用说明

## 📋 功能概述

这是一个功能强大的桌面自动化脚本，专门用于处理复杂的压缩包文件并提取其中的MP4视频文件。

### 🎯 主要功能

1. **图形化界面** - 提供友好的GUI界面，支持文件选择和进度显示
2. **多格式支持** - 支持 .tar.gz、.zip、.rar、.7z、.666z 等多种压缩格式
3. **智能解压** - 自动识别并递归解压内部的压缩文件
4. **文件重命名** - 自动将 .666z 文件重命名为 .7z 格式
5. **密码解压** - 支持使用默认密码解压加密的7z文件
6. **视频提取** - 递归搜索并提取所有 .mp4 视频文件
7. **自动清理** - 完成后自动删除中间产生的临时文件
8. **详细日志** - 提供完整的操作日志和错误处理

## 🚀 快速开始

### 第一步：安装依赖
1. 双击运行 `安装依赖库.bat`
2. 等待所有依赖库安装完成
3. 确认所有库都显示"✓"状态

### 第二步：运行脚本
1. 双击运行 `运行桌面自动化脚本.bat`
2. 或者直接运行 `python desktop_automation_script.py`

### 第三步：使用脚本
1. 在GUI界面中选择要处理的 .tar.gz 压缩包文件
2. 选择输出目录（默认为桌面）
3. 设置处理选项（推荐使用默认设置）
4. 点击"开始处理"按钮
5. 等待处理完成

## 📁 文件结构

```
桌面自动化脚本/
├── desktop_automation_script.py    # 主脚本文件
├── 运行桌面自动化脚本.bat          # 启动脚本
├── 安装依赖库.bat                  # 依赖安装脚本
├── 使用说明.md                     # 本说明文档
└── 输出文件/
    ├── extracted_mp4_files/        # 提取的MP4文件
    ├── temp_extract_*/             # 临时解压目录（自动清理）
    └── automation_log_*.log        # 操作日志文件
```

## ⚙️ 系统要求

### 必需环境
- **操作系统**: Windows 7/8/10/11
- **Python**: 3.7 或更高版本
- **内存**: 至少 2GB RAM
- **磁盘空间**: 根据处理文件大小而定

### Python依赖库
- `tkinter` - GUI界面（Python内置）
- `py7zr` - 7z文件支持
- `rarfile` - RAR文件支持
- 其他标准库：`tarfile`, `zipfile`, `shutil`, `threading`, `logging`

## 🔧 详细功能说明

### 1. 文件选择
- **源压缩包**: 选择要处理的 .tar.gz 文件
- **输出目录**: 选择MP4文件的保存位置（默认桌面）

### 2. 处理选项
- **自动清理中间文件**: 完成后删除临时文件和压缩包
- **递归解压内部压缩文件**: 自动处理压缩包内的压缩文件
- **7z默认密码**: 设置解压加密7z文件的密码（默认：chinatkclub.com）

### 3. 处理流程
1. **创建临时目录** - 在输出目录创建临时工作空间
2. **解压主压缩包** - 解压选择的 .tar.gz 文件
3. **处理内部文件** - 递归搜索并解压内部压缩文件
4. **重命名文件** - 将 .666z 文件重命名为 .7z
5. **解压7z文件** - 使用密码解压加密的7z文件
6. **提取MP4文件** - 搜索并复制所有MP4文件到输出目录
7. **清理临时文件** - 删除所有中间产生的文件

### 4. 日志记录
- 实时显示处理进度和状态
- 详细记录所有操作和错误信息
- 自动保存日志文件到桌面

## 🛠️ 故障排除

### 常见问题

**Q: 提示"未检测到Python环境"**
A: 请安装Python 3.7+，下载地址：https://www.python.org/downloads/
   安装时请勾选"Add Python to PATH"

**Q: 依赖库安装失败**
A: 
1. 尝试运行 `安装依赖库.bat` 重新安装
2. 检查网络连接
3. 尝试使用管理员权限运行

**Q: 7z文件解压失败**
A: 
1. 检查密码是否正确
2. 确认文件没有损坏
3. 尝试手动输入正确密码

**Q: 找不到MP4文件**
A: 
1. 确认压缩包内确实包含MP4文件
2. 检查文件扩展名是否正确（.mp4）
3. 查看日志了解详细处理过程

**Q: 程序运行缓慢**
A: 
1. 大文件处理需要时间，请耐心等待
2. 确保有足够的磁盘空间
3. 关闭其他占用资源的程序

### 错误代码说明

- **错误1**: Python环境问题
- **错误2**: 依赖库缺失
- **错误3**: 文件权限问题
- **错误4**: 磁盘空间不足
- **错误5**: 文件格式不支持

## 📞 技术支持

如果遇到问题，请：

1. **查看日志文件** - 检查桌面上的 `automation_log_*.log` 文件
2. **检查系统要求** - 确认Python版本和依赖库状态
3. **重新安装依赖** - 运行 `安装依赖库.bat` 重新安装
4. **联系技术支持** - 提供详细的错误信息和日志文件

## 📝 更新日志

### 版本 1.0 (2024-07-19)
- ✅ 初始版本发布
- ✅ 支持多种压缩格式
- ✅ 图形化用户界面
- ✅ 自动化处理流程
- ✅ 详细日志记录
- ✅ 错误处理和恢复

## 📄 许可证

本脚本仅供学习和个人使用，请勿用于商业用途。

---

**注意**: 使用本脚本处理文件时，请确保您有相应的文件使用权限。脚本会自动备份重要文件，但建议在处理前手动备份重要数据。